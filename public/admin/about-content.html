<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>About Content Manager - Admin</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" />
  <style>
    .fade-in {
      animation: fadeIn 0.3s ease-in;
    }

    @keyframes fadeIn {
      from {
        opacity: 0;
      }

      to {
        opacity: 1;
      }
    }

    .sidebar-mobile {
      transform: translateX(-100%);
      transition: transform 0.3s ease-in-out;
    }

    .sidebar-mobile.open {
      transform: translateX(0);
    }

    .btn-action {
      padding: 0.5rem 1rem;
      display: flex;
      align-items: center;
      width: 100%;
      text-align: left;
    }

    .btn-action i {
      margin-right: 0.5rem;
    }

    .section-divider {
      border-top: 2px solid #e5e7eb;
      margin: 2rem 0;
      padding-top: 2rem;
    }

    .input-group {
      margin-bottom: 1rem;
    }

    .tag-input {
      display: flex;
      flex-wrap: wrap;
      gap: 0.5rem;
      padding: 0.5rem;
      border: 1px solid #d1d5db;
      border-radius: 0.375rem;
      min-height: 2.5rem;
    }

    .tag {
      background-color: #3b82f6;
      color: white;
      padding: 0.25rem 0.5rem;
      border-radius: 0.25rem;
      display: flex;
      align-items: center;
      font-size: 0.875rem;
    }

    .tag button {
      margin-left: 0.5rem;
      background: none;
      border: none;
      color: white;
      cursor: pointer;
    }

    .card-item {
      border: 1px solid #e5e7eb;
      border-radius: 0.5rem;
      padding: 1rem;
      margin-bottom: 1rem;
      background-color: #f9fafb;
    }

    .card-item.active {
      border-color: #3b82f6;
      background-color: #eff6ff;
    }

    .toggle-switch {
      position: relative;
      display: inline-block;
      width: 60px;
      height: 34px;
    }

    .toggle-switch input {
      opacity: 0;
      width: 0;
      height: 0;
    }

    .slider {
      position: absolute;
      cursor: pointer;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background-color: #ccc;
      transition: 0.4s;
      border-radius: 34px;
    }

    .slider:before {
      position: absolute;
      content: "";
      height: 26px;
      width: 26px;
      left: 4px;
      bottom: 4px;
      background-color: white;
      transition: 0.4s;
      border-radius: 50%;
    }

    input:checked+.slider {
      background-color: #3b82f6;
    }

    input:checked+.slider:before {
      transform: translateX(26px);
    }
  </style>
</head>

<body class="bg-gray-100 font-sans">
  <!-- Loading Overlay -->
  <div id="loadingOverlay" class="fixed inset-0 bg-white z-50 flex flex-col items-center justify-center">
    <div class="animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-blue-500 mb-4"></div>
    <p class="text-gray-600">Loading about content...</p>
  </div>

  <!-- Main Content -->
  <div id="mainContent" class="hidden">
    <div class="flex h-screen">
      <!-- Mobile Hamburger Button -->
      <button id="mobileMenuButton"
        class="md:hidden fixed top-4 left-4 z-30 bg-gray-800 text-white py-1 px-2 rounded-md shadow-lg">
        <i class="fas fa-bars text-lg"></i>
      </button>

      <!-- Sidebar -->
      <div id="sidebar"
        class="w-64 bg-gray-800 text-white fixed md:relative h-full z-20 sidebar-mobile md:transform-none">
        <div class="p-4 border-b border-gray-700">
          <h1 class="text-sm md:text-xl font-bold pl-16 md:pl-0">
            VVWorx Admin Panel
          </h1>
        </div>
        <nav class="mt-4">
          <a href="/admin/dashboard.html" class="btn-action hover:bg-gray-700">
            <i class="fas fa-envelope"></i> Enquiry
          </a>
          <a href="/admin/our-work-content.html" class="btn-action hover:bg-gray-600">
            <i class="fas fa-briefcase"></i> Our Work (Home)
          </a>
          <a href="/admin/work-page-content.html" class="btn-action hover:bg-gray-600">
            <i class="fas fa-file-alt"></i> Our Work Detail
          </a>
          <a href="/admin/contact-content.html" class="btn-action hover:bg-gray-600">
            <i class="fas fa-phone"></i> Contact Page Content
          </a>
          <a href="/admin/about-page-content.html" class="btn-action hover:bg-gray-600">
            <i class="fas fa-user-circle"></i> About Page Content
          </a>
          <a href="/admin/services-content.html" class="btn-action hover:bg-gray-600">
            <i class="fas fa-cog"></i> Services Content
          </a>
          <a href="/admin/privacy-policy-content.html" class="btn-action hover:bg-gray-600">
            <i class="fas fa-cog"></i> privacy-policy
          </a>
          <a href="/admin/footer-content.html" class="btn-action hover:bg-gray-600">
            <i class="fas fa-grip-horizontal"></i> Footer Content
          </a>
          <button id="logoutBtn" class="btn-action hover:bg-gray-600">
            <i class="fas fa-sign-out-alt"></i> Logout
          </button>
        </nav>
      </div>

      <!-- Main Content Area -->
      <div class="flex-1 overflow-auto md:ml-0">
        <header class="bg-white shadow-sm p-4 md:ml-0 pl-16 md:pl-4">
          <div class="flex justify-between items-center">
            <h2 class="text-xl font-semibold text-gray-800">
              About Content Management
            </h2>
            <button id="saveBtn"
              class="bg-blue-600 text-white px-4 py-2 rounded-md hover:bg-blue-700 transition-colors">
              <i class="fas fa-save mr-2"></i>Save Changes
            </button>
          </div>
        </header>

        <main class="p-4">
          <form id="aboutForm" class="space-y-6">
            <!-- Hero Section -->
            <div class="bg-white rounded-lg shadow p-6">
              <h3 class="text-lg font-semibold text-gray-800 mb-4">
                <i class="fas fa-star mr-2 text-blue-600"></i>Hero Section
              </h3>

              <div class="input-group">
                <label class="block text-sm font-medium text-gray-700 mb-2">Main Title</label>
                <input type="text" id="heroMainTitle"
                  class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"
                  placeholder="e.g., We are" />
              </div>

              <div class="input-group">
                <label class="block text-sm font-medium text-gray-700 mb-2">Background Video Source</label>
                <div class="flex gap-2">
                  <input type="text" id="heroVideoSrc"
                    class="flex-1 px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"
                    placeholder="/hero.mp4" />
                  <button type="button" onclick="openVideoSelector('heroVideoSrc')"
                    class="bg-blue-500 text-white px-4 py-2 rounded-md hover:bg-blue-600 whitespace-nowrap">
                    <i class="fas fa-video mr-1"></i>Select Video
                  </button>
                </div>
                <div id="heroVideoSrcPreview" class="mt-2 hidden">
                  <video controls class="max-w-full h-32 rounded-md border">
                    Your browser does not support the video tag.
                  </video>
                </div>
              </div>

              <div class="section-divider"></div>
              <h4 class="text-md font-medium text-gray-800 mb-3">
                Rotating Texts
              </h4>
              <p class="text-sm text-gray-600 mb-3">
                ‚ú® <strong>Unlimited Animation Support!</strong> All texts
                will animate in sequence. Images cycle through available hero
                images.
              </p>

              <div class="mb-4">
                <div class="flex gap-2 mb-2">
                  <input type="text" id="newRotatingText"
                    class="flex-1 px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"
                    placeholder="Enter new rotating text" />
                  <button type="button" onclick="addRotatingText()"
                    class="bg-green-500 text-white px-4 py-2 rounded-md hover:bg-green-600">
                    <i class="fas fa-plus mr-1"></i>Add
                  </button>
                </div>
              </div>

              <div id="rotatingTextsContainer" class="space-y-2 mb-4">
                <!-- Dynamic rotating text inputs will be added here -->
              </div>

              <div class="section-divider"></div>
              <h4 class="text-md font-medium text-gray-800 mb-3">
                Hero Images
              </h4>
              <p class="text-sm text-gray-600 mb-3">
                üé® <strong>Unlimited Images Support!</strong> All images will
                animate in sequence with rotating texts.
              </p>

              <div class="mb-4">
                <div class="flex gap-2 mb-2">
                  <input type="text" id="newHeroImage"
                    class="flex-1 px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"
                    placeholder="Enter image URL or path" />
                  <button type="button" onclick="openImageSelector('newHeroImage')"
                    class="bg-blue-500 text-white px-3 py-1 rounded-md hover:bg-blue-600 text-sm">
                    <i class="fas fa-images mr-1"></i>Select
                  </button>
                  <button type="button" onclick="addHeroImage()"
                    class="bg-green-500 text-white px-4 py-2 rounded-md hover:bg-green-600">
                    <i class="fas fa-plus mr-1"></i>Add
                  </button>
                </div>
              </div>

              <div id="heroImagesContainer" class="space-y-2 mb-4">
                <!-- Dynamic hero image inputs will be added here -->
              </div>
            </div>

            <!-- About Section -->
            <div class="bg-white rounded-lg shadow p-6">
              <h3 class="text-lg font-semibold text-gray-800 mb-4">
                <i class="fas fa-info-circle mr-2 text-blue-600"></i>About
                Section
              </h3>
              <p class="text-sm text-gray-600 mb-3">
                üìù Add lines of text that will appear on the left side of the About section.
              </p>

              <div class="mb-4">
                <label class="block text-sm font-medium text-gray-700 mb-2">Section Title</label>
                <input type="text" id="aboutTitle"
                  class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"
                  placeholder="About Us" />
              </div>

              <div class="mb-4 input-group">
                <label class="block text-sm font-medium text-gray-700 mb-2">About Text Lines</label>
                <div class="flex gap-2 mb-2">
                  <input type="text" id="newAboutTextLine"
                    class="flex-1 px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"
                    placeholder="Enter new text line" />
                  <button type="button" onclick="addAboutTextLine()"
                    class="bg-green-500 text-white px-4 py-2 rounded-md hover:bg-green-600">
                    <i class="fas fa-plus mr-1"></i>Add
                  </button>
                </div>
              </div>

              <div id="aboutTextLinesContainer" class="space-y-2 mb-4">
                <!-- Dynamic about text lines will be added here -->
              </div>
            </div>

            <!-- Parallax Section -->
            <div class="bg-white rounded-lg shadow p-6">
              <h3 class="text-lg font-semibold text-gray-800 mb-4">
                <i class="fas fa-image mr-2 text-blue-600"></i>Parallax
                Section
              </h3>

              <div class="input-group">
                <label class="block text-sm font-medium text-gray-700 mb-2">Title</label>
                <textarea id="parallaxTitle" rows="3"
                  class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"
                  placeholder="Your Voice in the Future of Marketing."></textarea>
              </div>

              <div class="input-group">
                <label class="block text-sm font-medium text-gray-700 mb-2">Background Image</label>
                <div class="flex gap-2 mb-2">
                  <input type="text" id="parallaxBgImage"
                    class="flex-1 px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"
                    placeholder="/voice.jpg" />
                  <button type="button" onclick="openImageSelector('parallaxBgImage')"
                    class="bg-blue-500 text-white px-3 py-1 rounded-md hover:bg-blue-600 text-sm">
                    <i class="fas fa-images mr-1"></i>Select
                  </button>
                </div>
                <div id="parallaxBgImagePreview" class="image-preview hidden">
                  <img src="" alt="Preview" class="w-32 h-20 object-cover rounded border" />
                </div>
              </div>
            </div>

            <!-- Services Section -->
            <div class="bg-white rounded-lg shadow p-6">
              <h3 class="text-lg font-semibold text-gray-800 mb-4">
                <i class="fas fa-cogs mr-2 text-blue-600"></i>Services Section
              </h3>

              <div class="grid grid-cols-2 gap-4 mb-4">
                <div class="input-group">
                  <label class="block text-sm font-medium text-gray-700 mb-2">Section Title</label>
                  <input type="text" id="servicesTitle"
                    class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"
                    placeholder="Our Services" />
                </div>
                <div class="input-group">
                  <label class="block text-sm font-medium text-gray-700 mb-2">Background Image</label>
                  <div class="flex gap-2 mb-2">
                    <input type="text" id="servicesBgImage"
                      class="flex-1 px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"
                      placeholder="/serviceVector.png" />
                    <button type="button" onclick="openImageSelector('servicesBgImage')"
                      class="bg-blue-500 text-white px-3 py-1 rounded-md hover:bg-blue-600 text-sm">
                      <i class="fas fa-images mr-1"></i>Select
                    </button>
                  </div>
                  <div id="servicesBgImagePreview" class="image-preview hidden">
                    <img src="" alt="Preview" class="w-32 h-20 object-cover rounded border" />
                  </div>
                </div>
              </div>

              <div class="section-divider"></div>
              <div class="flex justify-between items-center mb-4">
                <h4 class="text-md font-medium text-gray-800">
                  Service Cards
                </h4>
                <button type="button" id="addServiceCardBtn"
                  class="bg-blue-600 text-white px-4 py-2 rounded-md hover:bg-blue-700 text-sm">
                  <i class="fas fa-plus mr-2"></i>Add New Card
                </button>
              </div>

              <div id="serviceCardsContainer" class="space-y-4">
                <!-- Dynamic service cards will be added here -->
              </div>
            </div>

            <!-- Foundation Section -->
            <div class="bg-white rounded-lg shadow p-6">
              <h3 class="text-lg font-semibold text-gray-800 mb-4">
                <i class="fas fa-building mr-2 text-blue-600"></i>Foundation
                Section
              </h3>

              <div class="grid grid-cols-2 gap-4 mb-4">
                <div class="input-group">
                  <label class="block text-sm font-medium text-gray-700 mb-2">Section Title Only Mobile</label>
                  <input type="text" id="foundationTitle"
                    class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"
                    placeholder="Our Foundation" />
                </div>
                <div class="input-group hidden">
                  <label class="block hidden text-sm font-medium text-gray-700 mb-2">Background Color</label>
                  <input type="color" id="foundationBgColor"
                    class="w-full h-10 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"
                    value="#6310FF" />
                </div>
              </div>

              <div class="section-divider"></div>
              <div class="flex justify-between items-center mb-4">
                <h4 class="text-md font-medium text-gray-800">
                  Foundation Items
                </h4>
                <button type="button" onclick="addFoundationItem()"
                  class="bg-blue-600 text-white px-4 py-2 rounded-md hover:bg-blue-700 text-sm">
                  <i class="fas fa-plus mr-2"></i>Add Item
                </button>
              </div>

              <div id="foundationsContainer" class="space-y-4">
                <!-- Dynamic foundation items will be added here -->
              </div>
            </div>

            <!-- Video Section -->
            <div class="bg-white rounded-lg shadow p-6">
              <h3 class="text-lg font-semibold text-gray-800 mb-4">
                <i class="fas fa-video mr-2 text-blue-600"></i>Video Section
              </h3>

              <div class="grid grid-cols-2 gap-4">
                <div class="input-group">
                  <label class="block text-sm font-medium text-gray-700 mb-2">Video Source</label>
                  <div class="flex gap-2 mb-2">
                    <input type="text" id="videoSrc"
                      class="flex-1 px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"
                      placeholder="/vua-intro.mp4" />
                    <button type="button" onclick="openVideoSelector('videoSrc')"
                      class="bg-blue-500 text-white px-4 py-2 rounded-md hover:bg-blue-600 whitespace-nowrap">
                      <i class="fas fa-video mr-1"></i>Select Video
                    </button>
                  </div>
                  <div id="videoSrcPreview" class="hidden">
                    <video controls class="max-w-full h-32 rounded-md border">
                      Your browser does not support the video tag.
                    </video>
                  </div>
                </div>
                <div class="input-group hidden">
                  <label class="block text-sm font-medium text-gray-700 mb-2">Background Color</label>
                  <input type="color" id="videoBgColor"
                    class="w-full h-10 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"
                    value="#EEF0FF" />
                </div>
              </div>
          </form>
        </main>
      </div>
    </div>
  </div>

  <script>
    let currentContent = null;

    // Initialize
    async function initializeAboutContent() {
      try {
        // First verify session
        const sessionResponse = await fetch("/api/auth/verify", {
          credentials: "include",
        });

        if (sessionResponse.status === 401) {
          window.location.href = "/login.html";
          return;
        }

        await loadCurrentContent();
        document.getElementById("loadingOverlay").classList.add("hidden");
        const mainContent = document.getElementById("mainContent");
        mainContent.classList.remove("hidden");
        mainContent.classList.add("fade-in");
        setupMobileMenu();
        setupEventListeners();
      } catch (error) {
        console.error("Initialization error:", error);
        window.location.href = "/login.html";
      }
    }

    // Load current content from API
    async function loadCurrentContent() {
      try {
        const response = await fetch("/api/about-content/active");
        const result = await response.json();

        if (result.success) {
          currentContent = result.data;
          populateForm(currentContent);
        } else {
          // Use default content if none exists
          populateForm({});
        }
      } catch (error) {
        console.error("Error loading content:", error);
        populateForm({});
      }
    }

    // Populate form with content data
    function populateForm(content = {}) {
      // Hero Section
      document.getElementById("heroMainTitle").value =
        content.heroSection?.mainTitle || "We are";
      document.getElementById("heroVideoSrc").value =
        content.heroSection?.backgroundVideo || "/hero.mp4";

      // Hero Images
      // Legacy code - now using dynamic arrays

      // Populate rotating texts
      populateRotatingTexts(
        content.heroSection?.rotatingTexts || [
          "Full-Service",
          "AI Infused",
          "Mar-Tech",
          "Creative",
        ]
      );
      populateHeroImages(
        content.heroSection?.heroImages || [
          "/fullservice.jpeg",
          "/ai.jpeg",
          "/tech.jpeg",
          "/creative.jpeg",
        ]
      );

      // About Text Lines
      document.getElementById("aboutTitle").value =
        content.aboutTitle || "About Us";

      populateAboutTextLines(
        content.aboutTextLines || [
          "Lorem Ipsum Dolor Sit Amet, Consectetuer Adipiscing Elit, Sed",
          "Diam Nonummy Nibh Euismod Tincidunt Ut Laoreet Dolore Magna",
          "Aliquam Erat Volutpat. Ut Wisi Enim Ad Minim Veniam, Quis Nostrud",
          "Exerci Tation Ullamcorper Suscipit Lobortis Nisl Ut Aliquip Ex Ea",
          "Commodo Consequat.",
        ]
      );

      // Parallax Section
      document.getElementById("parallaxTitle").value =
        content.parallaxSection?.title ||
        "Your Voice in the Future of Marketing.";
      document.getElementById("parallaxBgImage").value =
        content.parallaxSection?.backgroundImage || "/voice.jpg";

      // Services Section
      document.getElementById("servicesTitle").value =
        content.servicesSection?.title || "Our Services";
      document.getElementById("servicesBgImage").value =
        content.servicesSection?.backgroundImage || "/serviceVector.png";

      // Populate service cards
      populateServiceCards(content.servicesSection?.cards || []);

      // Foundation Section
      document.getElementById("foundationTitle").value =
        content.foundationSection?.title || "Our Foundation";
      document.getElementById("foundationBgColor").value =
        content.foundationSection?.backgroundColor || "#6310FF";

      // Populate foundations
      populateFoundations(content.foundationSection?.foundations || []);

      // Video Section
      document.getElementById("videoSrc").value =
        content.videoSection?.videoSrc || "/vua-intro.mp4";
      document.getElementById("videoBgColor").value =
        content.videoSection?.backgroundColor || "#EEF0FF";
    }

    // About Text Lines Management
    function populateAboutTextLines(lines) {
      const container = document.getElementById("aboutTextLinesContainer");
      container.innerHTML = "";

      const linesToUse = lines && lines.length > 0 ? lines : [];

      linesToUse.forEach((line, index) => {
        addAboutTextLineItem(line, index);
      });
    }

    function addAboutTextLine() {
      const input = document.getElementById("newAboutTextLine");
      const line = input.value.trim();

      if (!line) {
        showToast("Please enter a text line", "error");
        return;
      }

      const container = document.getElementById("aboutTextLinesContainer");
      const existingItems = container.querySelectorAll(".about-text-line-item").length;

      addAboutTextLineItem(line, existingItems);
      input.value = "";
      showToast("Text line added successfully", "success");
    }

    function addAboutTextLineItem(line, index) {
      const container = document.getElementById("aboutTextLinesContainer");
      const item = document.createElement("div");
      item.className = "mb-2 about-text-line-item border p-3 rounded-md bg-gray-50";
      item.innerHTML = `
            <div class="flex items-center justify-between mb-2">
                <label class="block text-sm font-medium text-gray-700">Line ${index + 1}</label>
                <button type="button" onclick="removeAboutTextLineItem(this)" class="text-red-500 hover:text-red-700">
                    <i class="fas fa-trash"></i>
                </button>
            </div>
            <input type="text" value="${line}" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 about-text-line-value" />
        `;
      container.appendChild(item);
    }

    function removeAboutTextLineItem(button) {
      button.closest(".about-text-line-item").remove();
      updateAboutTextLineLabels();
    }

    function updateAboutTextLineLabels() {
      const items = document.querySelectorAll("#aboutTextLinesContainer .about-text-line-item");
      items.forEach((item, index) => {
        const label = item.querySelector("label");
        label.textContent = `Line ${index + 1}`;
      });
    }

    function getAboutTextLines() {
      const items = document.querySelectorAll("#aboutTextLinesContainer .about-text-line-value");
      return Array.from(items)
        .map((input) => input.value)
        .filter((line) => line.trim() !== "");
    }

    // Rotating Texts Management
    function populateRotatingTexts(texts) {
      const container = document.getElementById("rotatingTextsContainer");
      container.innerHTML = "";

      // Use provided texts or defaults (no limit enforcement here)
      const textsToUse =
        texts && texts.length > 0
          ? texts
          : ["Full-Service", "AI Infused", "Mar-Tech", "Creative"];

      textsToUse.forEach((text, index) => {
        addRotatingTextItem(text, index);
      });
    }

    function addRotatingText() {
      const input = document.getElementById("newRotatingText");
      const text = input.value.trim();

      if (!text) {
        showToast("Please enter a rotating text", "error");
        return;
      }

      const container = document.getElementById("rotatingTextsContainer");
      const existingItems = container.querySelectorAll(
        ".rotating-text-item"
      ).length;

      if (existingItems >= 10) {
        showToast("Maximum 10 rotating texts allowed", "error");
        return;
      }

      addRotatingTextItem(text, existingItems);
      input.value = "";
      showToast("Rotating text added successfully", "success");
    }

    function addRotatingTextItem(text, index) {
      const container = document.getElementById("rotatingTextsContainer");
      const item = document.createElement("div");
      item.className =
        "mb-2 rotating-text-item border p-3 rounded-md bg-gray-50";
      item.innerHTML = `
                <div class="flex items-center justify-between mb-2">
                    <label class="block text-sm font-medium text-gray-700">Rotating Text ${index + 1
        }</label>
                    <button type="button" onclick="removeRotatingTextItem(this)" class="text-red-500 hover:text-red-700">
                        <i class="fas fa-trash"></i>
                    </button>
                </div>
                <input type="text" value="${text}" placeholder="Enter rotating text ${index + 1
        }" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 rotating-text-value" />
            `;
      container.appendChild(item);
    }

    function removeRotatingTextItem(button) {
      const container = document.getElementById("rotatingTextsContainer");
      const items = container.querySelectorAll(".rotating-text-item");

      if (items.length <= 1) {
        showToast("At least one rotating text is required", "error");
        return;
      }

      button.closest(".rotating-text-item").remove();
      updateRotatingTextLabels();
      showToast("Rotating text removed successfully", "success");
    }

    function updateRotatingTextLabels() {
      const items = document.querySelectorAll(
        "#rotatingTextsContainer .rotating-text-item"
      );
      items.forEach((item, index) => {
        const label = item.querySelector("label");
        const input = item.querySelector("input");
        label.textContent = `Rotating Text ${index + 1}`;
        input.placeholder = `Enter rotating text ${index + 1}`;
      });
    }

    function getRotatingTexts() {
      const items = document.querySelectorAll(
        "#rotatingTextsContainer .rotating-text-value"
      );
      return Array.from(items)
        .map((input) => input.value)
        .filter((text) => text.trim() !== "");
    }

    // Hero Images Management
    function populateHeroImages(images) {
      const container = document.getElementById("heroImagesContainer");
      container.innerHTML = "";

      // Use provided images or defaults
      const imagesToUse =
        images && images.length > 0
          ? images
          : ["/fullservice.jpeg", "/ai.jpeg", "/tech.jpeg", "/creative.jpeg"];

      imagesToUse.forEach((image, index) => {
        addHeroImageItem(image, index);
      });
    }

    function addHeroImage() {
      const input = document.getElementById("newHeroImage");
      const imagePath = input.value.trim();

      if (!imagePath) {
        showToast("Please enter an image URL or path", "error");
        return;
      }

      const container = document.getElementById("heroImagesContainer");
      const existingItems =
        container.querySelectorAll(".hero-image-item").length;

      if (existingItems >= 10) {
        showToast("Maximum 10 hero images allowed", "error");
        return;
      }

      addHeroImageItem(imagePath, existingItems);
      input.value = "";
      showToast("Hero image added successfully", "success");
    }

    function addHeroImageItem(imagePath, index) {
      const container = document.getElementById("heroImagesContainer");
      const item = document.createElement("div");
      item.className =
        "mb-3 hero-image-item border p-3 rounded-md bg-gray-50";
      item.innerHTML = `
                <div class="flex items-center justify-between mb-2">
                    <label class="block text-sm font-medium text-gray-700">Hero Image ${index + 1
        }</label>
                    <button type="button" onclick="removeHeroImageItem(this)" class="text-red-500 hover:text-red-700">
                        <i class="fas fa-trash"></i>
                    </button>
                </div>
                <div class="flex gap-2">
                    <input type="text" value="${imagePath}" class="flex-1 px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 hero-image-value" />
                    <button type="button" onclick="openImageSelectorForInput(this.previousElementSibling)" class="bg-blue-500 text-white px-3 py-1 rounded-md hover:bg-blue-600 text-sm">
                        <i class="fas fa-images"></i>
                    </button>
                </div>
                <div class="mt-2">
                    <img src="${imagePath}" class="w-full h-24 object-cover rounded border" onerror="this.src='/placeholder.jpg'" />
                </div>
            `;
      container.appendChild(item);
    }

    function removeHeroImageItem(button) {
      const container = document.getElementById("heroImagesContainer");
      const items = container.querySelectorAll(".hero-image-item");

      if (items.length <= 1) {
        showToast("At least one hero image is required", "error");
        return;
      }

      button.closest(".hero-image-item").remove();
      updateHeroImageLabels();
      showToast("Hero image removed successfully", "success");
    }

    function updateHeroImageLabels() {
      const items = document.querySelectorAll(
        "#heroImagesContainer .hero-image-item"
      );
      items.forEach((item, index) => {
        const label = item.querySelector("label");
        label.textContent = `Hero Image ${index + 1}`;
      });
    }

    function updateHeroImagePreview(input) {
      const item = input.closest(".hero-image-item");
      const preview = item.querySelector(".hero-image-preview");
      const img = preview.querySelector("img");
      const imagePath = input.value.trim();

      if (imagePath) {
        img.src = getImageUrl(imagePath);
        preview.classList.remove("hidden");
      } else {
        preview.classList.add("hidden");
      }
    }

    function openImageSelectorForHeroImage(button) {
      const input = button.previousElementSibling;
      // Temporarily store reference to the input for the image selector callback
      window.currentHeroImageInput = input;
      openImageSelector("heroImageTemp");
    }

    function getHeroImages() {
      const items = document.querySelectorAll(
        "#heroImagesContainer .hero-image-value"
      );
      return Array.from(items)
        .map((input) => input.value)
        .filter((path) => path.trim() !== "");
    }

    function getImageUrl(imagePath) {
      if (!imagePath) return "";
      if (imagePath.startsWith("http")) return imagePath;
      if (imagePath.startsWith("/uploads/"))
        return `http://15.206.84.81:8000${imagePath}`;
      return imagePath;
    }

    // Service Cards Management
    function populateServiceCards(cards) {
      const container = document.getElementById("serviceCardsContainer");
      container.innerHTML = "";

      // Sort cards by order
      const sortedCards = cards.sort((a, b) => a.order - b.order);

      sortedCards.forEach((card) => {
        addServiceCardItem(card);
      });
    }

    function addServiceCardItem(card) {
      const container = document.getElementById("serviceCardsContainer");
      const item = document.createElement("div");
      item.className = "card-item";
      item.dataset.id = card.id;

      const tagsString = Array.isArray(card.tags)
        ? card.tags.join(", ")
        : card.tags;

      item.innerHTML = `
                <div class="flex justify-between items-start mb-3">
                    <h5 class="font-semibold text-gray-800">${card.title}</h5>
                    <div class="flex gap-2">
                        <button type="button" onclick="editServiceCard('${card.id
        }')" class="text-blue-500 hover:text-blue-700">
                            <i class="fas fa-edit"></i>
                        </button>
                        <button type="button" onclick="deleteServiceCard('${card.id
        }')" class="text-red-500 hover:text-red-700">
                            <i class="fas fa-trash"></i>
                        </button>
                    </div>
                </div>
                <p class="text-sm text-gray-600 mb-2">${card.description}</p>
                <div class="flex flex-wrap gap-1 mb-2">
                    ${Array.isArray(card.tags)
          ? card.tags
            .map(
              (tag) =>
                `<span class="text-xs bg-blue-100 text-blue-800 px-2 py-1 rounded">${tag}</span>`
            )
            .join("")
          : ""
        }
                </div>
                <div class="flex justify-between items-center text-xs text-gray-500">
                    <span>Order: ${card.order}</span>
                    <span>Status: ${card.isActive
          ? '<span class="text-green-600">Active</span>'
          : '<span class="text-red-600">Inactive</span>'
        }</span>
                </div>
            `;
      container.appendChild(item);
    }

    function toggleCardActive(checkbox) {
      const cardItem = checkbox.closest(".card-item");
      if (checkbox.checked) {
        cardItem.classList.add("active");
      } else {
        cardItem.classList.remove("active");
      }
    }

    function removeServiceCard(button) {
      if (confirm("Are you sure you want to remove this card?")) {
        button.closest(".card-item").remove();
        updateCardNumbers();
      }
    }

    function updateCardNumbers() {
      const cards = document.querySelectorAll(
        "#serviceCardsContainer .card-item"
      );
      cards.forEach((card, index) => {
        const cardHeader = card.querySelector("h4");
        cardHeader.textContent = `Card ${index + 1}`;
      });
    }

    function handleTagInput(event, input) {
      if (event.key === "Enter") {
        event.preventDefault();
        const tagText = input.value.trim();
        if (tagText) {
          addTag(input.previousElementSibling, tagText);
          input.value = "";
        }
      }
    }

    function addTag(container, tagText) {
      const tag = document.createElement("div");
      tag.className = "tag";
      tag.innerHTML = `
                ${tagText}
                <button type="button" onclick="removeTag(this)">√ó</button>
            `;
      container.appendChild(tag);
    }

    function removeTag(button) {
      button.parentElement.remove();
    }

    function getTagsFromContainer(container) {
      const tags = container.querySelectorAll(".tag");
      return Array.from(tags).map((tag) =>
        tag.textContent.replace("√ó", "").trim()
      );
    }

    function getServiceCards() {
      const cardElements = document.querySelectorAll(
        "#serviceCardsContainer .card-item"
      );
      return Array.from(cardElements).map((cardElement) => {
        const tagsContainer = cardElement.querySelector(
          ".card-tags-container"
        );
        return {
          id: cardElement.getAttribute("data-card-id"),
          title: cardElement.querySelector(".card-title").value,
          description: cardElement.querySelector(".card-description").value,
          image: cardElement.querySelector(".card-image").value,
          tags: getTagsFromContainer(tagsContainer),
          imagePosition: cardElement.querySelector(".card-position").value,
          order:
            parseInt(cardElement.querySelector(".card-order").value) || 1,
          isActive: cardElement.querySelector('input[type="checkbox"]')
            .checked,
        };
      });
    }

    // Foundation Management
    function populateFoundations(foundations) {
      const container = document.getElementById("foundationsContainer");
      container.innerHTML = "";

      // Default foundation items if none exist
      const defaultFoundations = [
        {
          title: "Creativity",
          description: "Creativity that inspires",
          order: 1,
        },
        {
          title: "Innovation",
          description: "Technology that keeps You ahead",
          order: 2,
        },
        {
          title: "Strategic Thinking",
          description: "Strategy that always makes you win",
          order: 3,
        },
        {
          title: "Customer Centricity",
          description: 'Everything is about "You"',
          order: 4,
        },
      ];

      // Ensure exactly 4 foundation items
      const foundationsToUse =
        foundations.length >= 4
          ? foundations.slice(0, 4)
          : [...foundations, ...defaultFoundations.slice(foundations.length)];

      foundationsToUse.forEach((foundation, index) => {
        addFoundationItem(foundation, index);
      });
    }

    function addFoundationItem(foundation, index) {
      const container = document.getElementById("foundationsContainer");
      const foundationElement = document.createElement("div");
      foundationElement.className = "card-item";

      foundationElement.innerHTML = `
                <div class="mb-4">
                    <h4 class="text-md font-semibold text-gray-800">Foundation ${index + 1
        }</h4>
                </div>
                
                <div class="input-group mb-4">
                    <label class="block text-sm font-medium text-gray-700 mb-2">Title</label>
                    <input type="text" class="foundation-title w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500" value="${foundation.title
        }" placeholder="Enter foundation title" />
                </div>
                
                <div class="input-group">
                    <label class="block text-sm font-medium text-gray-700 mb-2">Description</label>
                    <input type="text" class="foundation-description w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500" value="${foundation.description
        }" placeholder="Enter foundation description" />
                </div>
            `;

      container.appendChild(foundationElement);
    }

    function getFoundations() {
      const foundationElements = document.querySelectorAll(
        "#foundationsContainer .card-item"
      );
      return Array.from(foundationElements).map(
        (foundationElement, index) => ({
          title: foundationElement.querySelector(".foundation-title").value,
          description: foundationElement.querySelector(
            ".foundation-description"
          ).value,
          order: index + 1,
        })
      );
    }

    // Event Listeners
    function setupEventListeners() {
      document
        .getElementById("saveBtn")
        .addEventListener("click", saveContent);
      document.getElementById("logoutBtn").addEventListener("click", logout);
      document
        .getElementById("addServiceCardBtn")
        .addEventListener("click", addServiceCard);
    }

    function addServiceCard() {
      const cards = getServiceCards();
      const maxOrder =
        cards.length > 0 ? Math.max(...cards.map((c) => c.order)) : 0;

      const newCard = {
        id: `card-${Date.now()}`,
        title: "",
        description: "",
        image: "",
        tags: [],
        imagePosition: "left",
        order: maxOrder + 1,
        isActive: true,
      };

      addServiceCardItem(newCard, cards.length);
    }

    // Save content
    async function saveContent() {
      const saveBtn = document.getElementById("saveBtn");
      const originalText = saveBtn.innerHTML;
      saveBtn.innerHTML =
        '<i class="fas fa-spinner fa-spin mr-2"></i>Saving...';
      saveBtn.disabled = true;

      try {
        const contentData = {
          heroSection: {
            mainTitle: document.getElementById("heroMainTitle").value,
            rotatingTexts: getRotatingTexts(),
            backgroundVideo: document.getElementById("heroVideoSrc").value,
            heroImages: getHeroImages(),
          },
          aboutTitle: document.getElementById("aboutTitle").value,
          aboutTextLines: getAboutTextLines(),
          parallaxSection: {
            title: document.getElementById("parallaxTitle").value,
            backgroundImage: document.getElementById("parallaxBgImage").value,
          },
          servicesSection: {
            title: document.getElementById("servicesTitle").value,
            backgroundImage: document.getElementById("servicesBgImage").value,
            cards: getServiceCards(),
          },
          foundationSection: {
            title: document.getElementById("foundationTitle").value,
            backgroundColor:
              document.getElementById("foundationBgColor").value,
            foundations: getFoundations(),
          },
          videoSection: {
            videoSrc: document.getElementById("videoSrc").value,
            backgroundColor: document.getElementById("videoBgColor").value,
          },
          lastUpdatedBy: "Admin",
        };

        const response = await fetch("/api/about-content", {
          method: "POST",
          headers: {
            "Content-Type": "application/json",
          },
          body: JSON.stringify(contentData),
          credentials: "include",
        });

        const result = await response.json();

        if (result.success) {
          alert("About content saved successfully!");
          currentContent = result.data;
        } else {
          alert("Error saving content: " + (result.message || result.error));
        }
      } catch (error) {
        console.error("Error saving content:", error);
        alert("Error saving content");
      } finally {
        saveBtn.innerHTML = originalText;
        saveBtn.disabled = false;
      }
    }

    // Setup mobile menu
    function setupMobileMenu() {
      const mobileMenuButton = document.getElementById("mobileMenuButton");
      const sidebar = document.getElementById("sidebar");

      mobileMenuButton.addEventListener("click", (e) => {
        e.stopPropagation();
        sidebar.classList.toggle("open");
      });

      // Close sidebar when clicking outside
      document.addEventListener("click", (e) => {
        if (
          !sidebar.contains(e.target) &&
          !mobileMenuButton.contains(e.target)
        ) {
          sidebar.classList.remove("open");
        }
      });
    }

    // Logout
    async function logout() {
      try {
        const response = await fetch("/api/auth/logout", {
          method: "POST",
          credentials: "include",
        });

        if (response.ok) {
          window.location.href = "/login.html";
        }
      } catch (error) {
        console.error("Logout error:", error);
      }
    }

    // Image Upload and Management Functions
    let currentImageInputId = null;

    function openImageSelector(inputId) {
      currentImageInputId = inputId;
      loadImages();
      document.getElementById("imageModal").classList.remove("hidden");
    }

    function closeImageModal() {
      document.getElementById("imageModal").classList.add("hidden");
      currentImageInputId = null;
      currentCardImageInput = null;
    }

    async function loadImages() {
      try {
        const response = await fetch("/api/images/list");
        const result = await response.json();

        if (result.success) {
          populateImageGrid(result.data);
        } else {
          console.error("Error loading images:", result.message);
        }
      } catch (error) {
        console.error("Error loading images:", error);
      }
    }

    function populateImageGrid(images) {
      const grid = document.getElementById("imageGrid");
      grid.innerHTML = "";

      images.forEach((image) => {
        const imageItem = document.createElement("div");
        imageItem.className =
          "relative group border-2 border-gray-200 hover:border-blue-500 rounded-lg overflow-hidden";

        imageItem.innerHTML = `
                    <div class="cursor-pointer" onclick="selectImage('${image.url}')">
                        <img src="${image.url}" alt="${image.filename}" class="w-full h-24 object-cover">
                        <div class="absolute inset-0 bg-black bg-opacity-0 group-hover:bg-opacity-20 flex items-center justify-center">
                            <i class="fas fa-check text-white opacity-0 group-hover:opacity-100 text-xl"></i>
                        </div>
                    </div>
                    <div class="absolute bottom-0 left-0 right-0 bg-black bg-opacity-50 text-white text-xs p-1 truncate">
                        ${image.filename}
                    </div>
                    <button 
                        onclick="deleteImage('${image.filename}', event)" 
                        class="absolute top-1 right-1 bg-red-500 text-white rounded-full w-6 h-6 flex items-center justify-center opacity-0 group-hover:opacity-100 hover:bg-red-600 transition-opacity duration-200"
                        title="Delete image"
                    >
                        <i class="fas fa-trash text-xs"></i>
                    </button>
                `;

        grid.appendChild(imageItem);
      });
    }

    function selectImage(imageUrl) {
      if (
        currentImageInputId === "card-image-temp" &&
        currentCardImageInput
      ) {
        // Handle service card image selection
        currentCardImageInput.value = imageUrl;
        const previewElement =
          currentCardImageInput.parentElement.nextElementSibling;
        if (
          previewElement &&
          previewElement.classList.contains("card-image-preview")
        ) {
          const img = previewElement.querySelector("img");
          if (img) {
            img.src = imageUrl;
            previewElement.classList.remove("hidden");
          }
        }
        closeImageModal();
      } else if (
        currentImageInputId === "heroImageTemp" &&
        window.currentHeroImageInput
      ) {
        // Handle hero image selection
        window.currentHeroImageInput.value = imageUrl;
        updateHeroImagePreview(window.currentHeroImageInput);
        window.currentHeroImageInput = null;
        closeImageModal();
      } else if (currentImageInputId === "newHeroImage") {
        // Handle new hero image input
        document.getElementById("newHeroImage").value = imageUrl;
        closeImageModal();
      } else if (currentImageInputId) {
        // Handle regular image selection
        document.getElementById(currentImageInputId).value = imageUrl;
        updateImagePreview(currentImageInputId, imageUrl);
        closeImageModal();
      }
    }

    function updateImagePreview(inputId, imageUrl) {
      const previewElement = document.getElementById(inputId + "Preview");
      if (previewElement) {
        const img = previewElement.querySelector("img");
        img.src = imageUrl;
        previewElement.classList.remove("hidden");
      }
    }

    function openCardImageSelector(button) {
      const cardInput = button.parentElement.querySelector(".card-image");
      currentImageInputId = "card-image-temp";
      currentCardImageInput = cardInput;
      loadImages();
      document.getElementById("imageModal").classList.remove("hidden");
    }

    let currentCardImageInput = null;

    async function uploadImage() {
      const fileInput = document.getElementById("imageUploadInput");
      const file = fileInput.files[0];

      if (!file) {
        alert("Please select a file to upload");
        return;
      }

      const formData = new FormData();
      formData.append("image", file);

      try {
        document.getElementById("uploadProgress").classList.remove("hidden");

        const response = await fetch("/api/images/upload", {
          method: "POST",
          body: formData,
        });

        const result = await response.json();

        if (result.success) {
          alert("Image uploaded successfully!");
          fileInput.value = "";
          loadImages(); // Refresh the image grid
        } else {
          alert("Error uploading image: " + result.message);
        }
      } catch (error) {
        console.error("Upload error:", error);
        alert("Error uploading image");
      } finally {
        document.getElementById("uploadProgress").classList.add("hidden");
      }
    }

    // Delete image function
    async function deleteImage(filename, event) {
      // Prevent the click from bubbling up to the select image function
      event.stopPropagation();

      // Confirm deletion
      if (
        !confirm(
          `Are you sure you want to delete "${filename}"? This action cannot be undone.`
        )
      ) {
        return;
      }

      try {
        const response = await fetch(`/api/images/delete/${filename}`, {
          method: "DELETE",
        });

        const result = await response.json();

        if (result.success) {
          alert("Image deleted successfully!");
          loadImages(); // Refresh the image grid
        } else {
          alert("Error deleting image: " + result.message);
        }
      } catch (error) {
        console.error("Delete error:", error);
        alert("Error deleting image");
      }
    }

    // Video Upload and Management Functions
    let currentVideoInputId = null;

    function openVideoSelector(inputId) {
      currentVideoInputId = inputId;
      loadVideos();
      document.getElementById("videoModal").classList.remove("hidden");
    }

    function closeVideoModal() {
      document.getElementById("videoModal").classList.add("hidden");
      currentVideoInputId = null;
    }

    async function loadVideos() {
      try {
        const response = await fetch("/api/videos/list");
        const result = await response.json();

        if (result.success) {
          populateVideoGrid(result.data);
        } else {
          console.error("Error loading videos:", result.message);
        }
      } catch (error) {
        console.error("Error loading videos:", error);
      }
    }

    function populateVideoGrid(videos) {
      const grid = document.getElementById("videoGrid");
      grid.innerHTML = "";

      videos.forEach((video) => {
        const videoItem = document.createElement("div");
        videoItem.className =
          "relative group border-2 border-gray-200 hover:border-purple-500 rounded-lg overflow-hidden";

        const fileSizeMB = (video.size / (1024 * 1024)).toFixed(1);

        videoItem.innerHTML = `
                    <div class="cursor-pointer" onclick="selectVideo('${video.url}')">
                        <video class="w-full h-24 object-cover bg-gray-200" preload="metadata" muted onloadedmetadata="this.currentTime = 0.1">
                            <source src="${video.url}" type="video/mp4">
                        </video>
                        <div class="absolute inset-0 bg-black bg-opacity-0 group-hover:bg-opacity-20 flex items-center justify-center">
                            <i class="fas fa-play text-white opacity-0 group-hover:opacity-100 text-xl"></i>
                        </div>
                    </div>
                    <div class="absolute bottom-0 left-0 right-0 bg-black bg-opacity-50 text-white text-xs p-1">
                        <div class="truncate">${video.filename}</div>
                        <div class="text-gray-300">${fileSizeMB}MB</div>
                    </div>
                    <button 
                        onclick="deleteVideo('${video.filename}', event)" 
                        class="absolute top-1 right-1 bg-red-500 text-white rounded-full w-6 h-6 flex items-center justify-center opacity-0 group-hover:opacity-100 hover:bg-red-600 transition-opacity duration-200"
                        title="Delete video"
                    >
                        <i class="fas fa-trash text-xs"></i>
                    </button>
                `;

        // After adding to DOM, try to load the video thumbnail
        grid.appendChild(videoItem);

        // Force thumbnail generation by seeking to a specific time
        const videoElement = videoItem.querySelector("video");
        videoElement.addEventListener("loadedmetadata", function () {
          this.currentTime = Math.min(0.5, this.duration * 0.1); // Seek to 10% or 0.5s, whichever is smaller
        });
      });
    }

    function selectVideo(videoUrl) {
      if (currentVideoInputId) {
        document.getElementById(currentVideoInputId).value = videoUrl;
        updateVideoPreview(currentVideoInputId, videoUrl);
        closeVideoModal();
      }
    }

    function updateVideoPreview(inputId, videoUrl) {
      const previewElement = document.getElementById(inputId + "Preview");
      if (previewElement) {
        const video = previewElement.querySelector("video");
        video.src = videoUrl;
        previewElement.classList.remove("hidden");
      }
    }

    async function uploadVideo() {
      const fileInput = document.getElementById("videoUploadInput");
      const file = fileInput.files[0];

      if (!file) {
        alert("Please select a video file to upload");
        return;
      }

      const formData = new FormData();
      formData.append("video", file);

      try {
        document
          .getElementById("videoUploadProgress")
          .classList.remove("hidden");

        const response = await fetch("/api/videos/upload", {
          method: "POST",
          body: formData,
        });

        const result = await response.json();

        if (result.success) {
          alert("Video uploaded successfully!");
          fileInput.value = "";
          loadVideos(); // Refresh the video grid
        } else {
          alert("Error uploading video: " + result.message);
        }
      } catch (error) {
        console.error("Video upload error:", error);
        alert("Error uploading video");
      } finally {
        document
          .getElementById("videoUploadProgress")
          .classList.add("hidden");
      }
    }

    async function deleteVideo(filename, event) {
      event.stopPropagation();

      if (
        !confirm(
          `Are you sure you want to delete "${filename}"? This action cannot be undone.`
        )
      ) {
        return;
      }

      try {
        const response = await fetch(`/api/videos/delete/${filename}`, {
          method: "DELETE",
        });

        const result = await response.json();

        if (result.success) {
          alert("Video deleted successfully!");
          loadVideos(); // Refresh the video grid
        } else {
          alert("Error deleting video: " + result.message);
        }
      } catch (error) {
        console.error("Delete video error:", error);
        alert("Error deleting video");
      }
    }

    // Update image previews on page load
    function updateAllImagePreviews() {
      const imageInputs = ["parallaxBgImage", "servicesBgImage"];

      imageInputs.forEach((inputId) => {
        const input = document.getElementById(inputId);
        if (input && input.value) {
          updateImagePreview(inputId, input.value);
        }
      });
    }

    // Update video previews on page load
    function updateAllVideoPreviews() {
      const videoInputs = ["heroVideoSrc", "videoSrc"];

      videoInputs.forEach((inputId) => {
        const input = document.getElementById(inputId);
        if (input && input.value) {
          updateVideoPreview(inputId, input.value);
        }
      });
    }

    // Initialize when page loads
    document.addEventListener("DOMContentLoaded", () => {
      initializeAboutContent();
      updateAllImagePreviews();
      updateAllVideoPreviews();
    });
  </script>

  <!-- Image Upload Modal -->
  <div id="imageModal" class="hidden fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center">
    <div class="bg-white rounded-lg shadow-xl max-w-4xl w-full mx-4 max-h-[90vh] overflow-hidden">
      <div class="flex justify-between items-center p-4 border-b">
        <h3 class="text-lg font-semibold">Select Image</h3>
        <button onclick="closeImageModal()" class="text-gray-500 hover:text-gray-700">
          <i class="fas fa-times text-xl"></i>
        </button>
      </div>

      <div class="p-4">
        <!-- Upload Section -->
        <div class="mb-6 p-4 border-2 border-dashed border-gray-300 rounded-lg">
          <div class="text-center">
            <i class="fas fa-cloud-upload-alt text-3xl text-gray-400 mb-2"></i>
            <p class="text-gray-600 mb-2">Upload a new image</p>
            <input type="file" id="imageUploadInput" accept="image/*" class="mb-2" />
            <button onclick="uploadImage()" class="bg-green-500 text-white px-4 py-2 rounded-md hover:bg-green-600">
              <i class="fas fa-upload mr-1"></i>Upload
            </button>
            <div id="uploadProgress" class="hidden mt-2">
              <div class="text-blue-600">Uploading...</div>
            </div>
          </div>
        </div>

        <!-- Image Grid -->
        <div class="mb-4">
          <h4 class="text-md font-semibold mb-2">
            Select from uploaded images:
          </h4>
          <div id="imageGrid" class="grid grid-cols-6 gap-2 max-h-64 overflow-y-auto">
            <!-- Images will be loaded here -->
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Video Upload Modal -->
  <div id="videoModal" class="hidden fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center">
    <div class="bg-white rounded-lg shadow-xl max-w-4xl w-full mx-4 max-h-[90vh] overflow-hidden">
      <div class="flex justify-between items-center p-4 border-b">
        <h3 class="text-lg font-semibold">Select Video</h3>
        <button onclick="closeVideoModal()" class="text-gray-500 hover:text-gray-700">
          <i class="fas fa-times text-xl"></i>
        </button>
      </div>

      <div class="p-4">
        <!-- Upload Section -->
        <div class="mb-6 p-4 border-2 border-dashed border-purple-300 rounded-lg">
          <div class="text-center">
            <i class="fas fa-video text-3xl text-purple-400 mb-2"></i>
            <p class="text-gray-600 mb-2">Upload a new video</p>
            <p class="text-xs text-gray-500 mb-2">
              Supported formats: MP4, MOV, AVI, MKV, WebM (Max: 100MB)
            </p>
            <input type="file" id="videoUploadInput" accept="video/*" class="mb-2" />
            <button onclick="uploadVideo()" class="bg-purple-500 text-white px-4 py-2 rounded-md hover:bg-purple-600">
              <i class="fas fa-upload mr-1"></i>Upload Video
            </button>
            <div id="videoUploadProgress" class="hidden mt-2">
              <div class="text-purple-600">Uploading video...</div>
              <div class="w-full bg-gray-200 rounded-full h-2 mt-1">
                <div id="videoProgressBar" class="bg-purple-600 h-2 rounded-full" style="width: 0%"></div>
              </div>
            </div>
          </div>
        </div>

        <!-- Video Grid -->
        <div class="mb-4">
          <h4 class="text-md font-semibold mb-2">
            Select from uploaded videos:
          </h4>
          <div id="videoGrid" class="grid grid-cols-3 gap-3 max-h-64 overflow-y-auto">
            <!-- Videos will be loaded here -->
          </div>
        </div>
      </div>
    </div>
  </div>
</body>

</html>