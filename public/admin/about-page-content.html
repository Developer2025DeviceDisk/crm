<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>About Page Content Manager - Admin</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" />
  <style>
    .fade-in {
      animation: fadeIn 0.3s ease-in;
    }

    @keyframes fadeIn {
      from {
        opacity: 0;
      }

      to {
        opacity: 1;
      }
    }

    .sidebar-mobile {
      transform: translateX(-100%);
      transition: transform 0.3s ease-in-out;
    }

    .sidebar-mobile.open {
      transform: translateX(0);
    }

    .btn-action {
      padding: 0.5rem 1rem;
      display: flex;
      align-items: center;
      width: 100%;
      text-align: left;
    }

    .btn-action i {
      margin-right: 0.5rem;
    }

    .section-divider {
      border-top: 2px solid #e5e7eb;
      margin: 2rem 0;
      padding-top: 2rem;
    }

    .input-group {
      margin-bottom: 1rem;
    }

    .team-member-card,
    .director-card {
      border: 2px solid #e5e7eb;
      border-radius: 0.5rem;
      padding: 1rem;
      margin: 1rem 0;
      background: #f9fafb;
    }

    .foundation-item {
      border: 1px solid #d1d5db;
      border-radius: 0.375rem;
      padding: 1rem;
      margin: 0.5rem 0;
      background: white;
    }

    .image-preview {
      margin-top: 0.5rem;
    }

    .image-preview.hidden {
      display: none;
    }
  </style>
</head>

<body class="bg-gray-100 font-sans">
  <!-- Loading Overlay -->
  <div id="loadingOverlay" class="fixed inset-0 bg-white z-50 flex flex-col items-center justify-center">
    <div class="animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-blue-500 mb-4"></div>
    <p class="text-gray-600">Loading about page content...</p>
  </div>

  <!-- Main Content -->
  <div id="mainContent" class="hidden">
    <div class="flex h-screen">
      <!-- Mobile Hamburger Button -->
      <button id="mobileMenuButton"
        class="md:hidden fixed top-4 left-4 z-30 bg-gray-800 text-white py-1 px-2 rounded-md shadow-lg">
        <i class="fas fa-bars text-lg"></i>
      </button>

      <!-- Sidebar -->
      <div id="sidebar"
        class="w-64 bg-gray-800 text-white fixed md:relative h-full z-20 sidebar-mobile md:transform-none">
        <div class="p-4 border-b border-gray-700">
          <h1 class="text-sm md:text-xl font-bold pl-16 md:pl-0">
            VVWorx Admin Panel
          </h1>
        </div>
        <nav class="mt-4">
          <a href="/admin/dashboard.html" class="btn-action hover:bg-gray-700">
            <i class="fas fa-envelope"></i> Enquiry
          </a>
          <a href="/admin/about-content.html" class="btn-action hover:bg-gray-600">
            <i class="fas fa-cog"></i> Home Content
          </a>
          <a href="/admin/our-work-content.html" class="btn-action hover:bg-gray-600">
            <i class="fas fa-briefcase"></i> Our Work (Home)
          </a>
          <a href="/admin/work-page-content.html" class="btn-action hover:bg-gray-600">
            <i class="fas fa-file-alt"></i> Our Work Detail
          </a>
          <a href="/admin/contact-content.html" class="btn-action hover:bg-gray-600">
            <i class="fas fa-phone"></i> Contact Page Content
          </a>
          <a href="/admin/about-page-content.html" class="btn-action bg-gray-600">
            <i class="fas fa-user-circle"></i> About Page Content
          </a>
          <a href="/admin/services-content.html" class="btn-action hover:bg-gray-600">
            <i class="fas fa-cog"></i> Services Content
          </a>
          <a href="/admin/privacy-policy-content.html" class="btn-action hover:bg-gray-600">
            <i class="fas fa-cog"></i> Privacy Policy
          </a>
          <a href="/admin/footer-content.html" class="btn-action hover:bg-gray-600">
            <i class="fas fa-grip-horizontal"></i> Footer Content
          </a>
          <button id="logoutBtn" class="btn-action hover:bg-gray-600">
            <i class="fas fa-sign-out-alt"></i> Logout
          </button>
        </nav>
      </div>

      <!-- Main Content Area -->
      <div class="flex-1 overflow-auto md:ml-0">
        <header class="bg-white shadow-sm p-4 md:ml-0 pl-16 md:pl-4">
          <div class="flex justify-between items-center">
            <h2 class="text-xl font-semibold text-gray-800">
              About Page Content Management
            </h2>
            <button id="saveBtn"
              class="bg-blue-600 text-white px-4 py-2 rounded-md hover:bg-blue-700 transition-colors">
              <i class="fas fa-save mr-2"></i>Save Changes
            </button>
          </div>
        </header>

        <!-- Success/Error Messages -->
        <div id="messageContainer" class="hidden mx-4 mt-4 p-4 rounded-lg"></div>

        <main class="p-4">
          <form id="aboutPageForm" class="space-y-6">
            <!-- Header Section -->
            <div class="bg-white rounded-lg shadow p-6">
              <h3 class="text-lg font-semibold text-gray-800 mb-4">
                Header Section
              </h3>

              <div class="grid md:grid-cols-2 gap-4">
                <div class="input-group">
                  <label class="block text-sm font-medium text-gray-700 mb-2">Title Line 1</label>
                  <input type="text" id="headerTitleLine1"
                    class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"
                    placeholder="Your Voice In" />
                </div>
                <div class="input-group">
                  <label class="block text-sm font-medium text-gray-700 mb-2">Title Line 2</label>
                  <input type="text" id="headerTitleLine2"
                    class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"
                    placeholder="The Future Of" />
                </div>
                <div class="input-group">
                  <label class="block text-sm font-medium text-gray-700 mb-2">Title Line 3</label>
                  <input type="text" id="headerTitleLine3"
                    class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"
                    placeholder="Marketing." />
                </div>
                <div class="input-group hidden">
                  <label class="block text-sm font-medium text-gray-700 mb-2">Background Gradient</label>
                  <input type="text" id="headerBackgroundGradient"
                    class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"
                    placeholder="from-[#6210FF] to-[#BE2FF4]" />
                </div>
                <div class="input-group">
                  <label class="block text-sm font-medium text-gray-700 mb-2">Hero Image Path</label>
                  <div class="flex gap-2 mb-2">
                    <input type="text" id="headerHeroImage"
                      class="flex-1 px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"
                      placeholder="/Marketingwoman.png" />
                    <button type="button" onclick="openImageSelector('headerHeroImage')"
                      class="bg-blue-500 text-white px-3 py-1 rounded-md hover:bg-blue-600 text-sm">
                      <i class="fas fa-images mr-1"></i>Select
                    </button>
                  </div>
                  <div id="headerHeroImagePreview" class="image-preview hidden">
                    <img src="" alt="Preview" class="w-32 h-20 object-cover rounded border" />
                  </div>
                </div>
                <div class="input-group">
                  <label class="block text-sm font-medium text-gray-700 mb-2">Decorative Image Path</label>
                  <div class="flex gap-2 mb-2">
                    <input type="text" id="headerDecorativeImage"
                      class="flex-1 px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"
                      placeholder="/Markofinnovation.png" />
                    <button type="button" onclick="openImageSelector('headerDecorativeImage')"
                      class="bg-blue-500 text-white px-3 py-1 rounded-md hover:bg-blue-600 text-sm">
                      <i class="fas fa-images mr-1"></i>Select
                    </button>
                  </div>
                  <div id="headerDecorativeImagePreview" class="image-preview hidden">
                    <img src="" alt="Preview" class="w-32 h-20 object-cover rounded border" />
                  </div>
                </div>
              </div>
            </div>

            <!-- About Us Section -->
            <div class="bg-white rounded-lg shadow p-6">
              <h3 class="text-lg font-semibold text-gray-800 mb-4">
                About Us Section
              </h3>

              <div class="grid md:grid-cols-2 gap-4">
                <div class="input-group">
                  <label class="block text-sm font-medium text-gray-700 mb-2">Main Text Line 1</label>
                  <input type="text" id="aboutMainTextLine1"
                    class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"
                    placeholder="'Vua' is the Voice that will lead the dialogue" />
                </div>
                <div class="input-group">
                  <label class="block text-sm font-medium text-gray-700 mb-2">Main Text Line 2</label>
                  <input type="text" id="aboutMainTextLine2"
                    class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"
                    placeholder="for a future-forward world of Marketing." />
                </div>
                <div class="input-group hidden">
                  <label class="block text-sm font-medium text-gray-700 mb-2">Text Color</label>
                  <input type="text" id="aboutTextColor"
                    class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"
                    placeholder="#6210FF" />
                </div>
                <div class="input-group hidden">
                  <label class="block text-sm font-medium text-gray-700 mb-2">Background Color</label>
                  <input type="text" id="aboutBackgroundColor"
                    class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"
                    placeholder="#EEF0FF" />
                </div>
              </div>
            </div>

            <!-- Who Are We Section -->
            <div class="bg-white rounded-lg shadow p-6">
              <h3 class="text-lg font-semibold text-gray-800 mb-4">
                Who Are We Section
              </h3>

              <div class="grid md:grid-cols-2 gap-4 mb-4">
                <div class="input-group">
                  <label class="block text-sm font-medium text-gray-700 mb-2">Section Title</label>
                  <input type="text" id="whoAreWeTitle"
                    class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"
                    placeholder="Who Are We?" />
                </div>
                <div class="input-group">
                  <label class="block text-sm font-medium text-gray-700 mb-2">Background Image</label>
                  <div class="flex gap-2 mb-2">
                    <input type="text" id="whoAreWeBackgroundImage"
                      class="flex-1 px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"
                      placeholder="/Whoarewe.png" />
                    <button type="button" onclick="openImageSelector('whoAreWeBackgroundImage')"
                      class="bg-blue-500 text-white px-3 py-1 rounded-md hover:bg-blue-600 text-sm">
                      <i class="fas fa-images mr-1"></i>Select
                    </button>
                  </div>
                  <div id="whoAreWeBackgroundImagePreview" class="image-preview hidden">
                    <img src="" alt="Preview" class="w-32 h-20 object-cover rounded border" />
                  </div>
                </div>
                <div class="input-group">
                  <label class="block text-sm font-medium text-gray-700 mb-2">Decorative Arc Image</label>
                  <div class="flex gap-2 mb-2">
                    <input type="text" id="whoAreWeDecorativeArc"
                      class="flex-1 px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"
                      placeholder="/Layer_1.png" />
                    <button type="button" onclick="openImageSelector('whoAreWeDecorativeArc')"
                      class="bg-blue-500 text-white px-3 py-1 rounded-md hover:bg-blue-600 text-sm">
                      <i class="fas fa-images mr-1"></i>Select
                    </button>
                  </div>
                  <div id="whoAreWeDecorativeArcPreview" class="image-preview hidden">
                    <img src="" alt="Preview" class="w-32 h-20 object-cover rounded border" />
                  </div>
                </div>
                <div class="input-group">
                  <label class="block text-sm font-medium text-gray-700 mb-2">Astronaut Image</label>
                  <div class="flex gap-2 mb-2">
                    <input type="text" id="whoAreWeAstronaut"
                      class="flex-1 px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"
                      placeholder="/astro.png" />
                    <button type="button" onclick="openImageSelector('whoAreWeAstronaut')"
                      class="bg-blue-500 text-white px-3 py-1 rounded-md hover:bg-blue-600 text-sm">
                      <i class="fas fa-images mr-1"></i>Select
                    </button>
                  </div>
                  <div id="whoAreWeAstronautPreview" class="image-preview hidden">
                    <img src="" alt="Preview" class="w-32 h-20 object-cover rounded border" />
                  </div>
                </div>
              </div>
              <div class="input-group">
                <label class="block text-sm font-medium text-gray-700 mb-2">Paragraph 1</label>
                <textarea id="whoAreWeParagraph1" rows="3"
                  class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"
                  placeholder="We are a future-focused Marketing agency..."></textarea>
              </div>
              <div class="input-group">
                <label class="block text-sm font-medium text-gray-700 mb-2">Highlight Text</label>
                <textarea id="whoAreWeHighlightText" rows="2"
                  class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"
                  placeholder="Our 360-degree service portfolio..."></textarea>
              </div>
              <div class="input-group">
                <label class="block text-sm font-medium text-gray-700 mb-2">Paragraph 1 Continuation</label>
                <textarea id="whoAreWeParagraph1Continuation" rows="2"
                  class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"
                  placeholder="empowers brands to lead..."></textarea>
              </div>
              <div class="input-group">
                <label class="block text-sm font-medium text-gray-700 mb-2">Paragraph 2</label>
                <textarea id="whoAreWeParagraph2" rows="2"
                  class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"
                  placeholder="VUA is more than a brand..."></textarea>
              </div>
            </div>

            <!-- Foundation Section -->
            <div class="bg-white rounded-lg shadow p-6">
              <h3 class="text-lg font-semibold text-gray-800 mb-4">
                Foundation Section (Fixed 4 Items)
              </h3>

              <div class="grid md:grid-cols-2 gap-4 mb-4">
                <div class="input-group">
                  <label class="block text-sm font-medium text-gray-700 mb-2">Section Title</label>
                  <input type="text" id="foundationTitle"
                    class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"
                    placeholder="Our Foundation" />
                </div>
                <div class="input-group hidden">
                  <label class="block text-sm font-medium text-gray-700 mb-2">Background Color</label>
                  <input type="text" id="foundationBackgroundColor"
                    class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"
                    placeholder="#6310FF" />
                </div>
              </div>
              <div id="foundationItems">
                <!-- Foundation items will be populated by JavaScript -->
              </div>
            </div>

            <!-- Director Section -->
            <div class="bg-white rounded-lg shadow p-6">
              <h3 class="text-lg font-semibold text-gray-800 mb-4">
                Director Section
              </h3>

              <div class="grid md:grid-cols-2 gap-4 mb-4">
                <div class="input-group">
                  <label class="block text-sm font-medium text-gray-700 mb-2">Section Title</label>
                  <input type="text" id="directorSectionTitle"
                    class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"
                    placeholder="Director" />
                </div>
                <div class="input-group hidden">
                  <label class="block text-sm font-medium text-gray-700 mb-2">Background Color</label>
                  <input type="text" id="directorBackgroundColor"
                    class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"
                    placeholder="#EEF0FF" />
                </div>
              </div>
              <div id="directorItems">
                <!-- Director items will be populated by JavaScript -->
              </div>
              <button type="button" onclick="addDirector()"
                class="bg-green-600 text-white px-4 py-2 rounded-md hover:bg-green-700 transition-colors mt-4">
                <i class="fas fa-plus mr-2"></i>Add Director
              </button>
            </div>

            <!-- Team Section -->
            <div class="bg-white rounded-lg shadow p-6">
              <h3 class="text-lg font-semibold text-gray-800 mb-4">
                Team Section
              </h3>

              <div class="grid md:grid-cols-3 gap-4 mb-4">
                <div class="input-group">
                  <label class="block text-sm font-medium text-gray-700 mb-2">Section Title</label>
                  <input type="text" id="teamSectionTitle"
                    class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"
                    placeholder="Our Team" />
                </div>
                <div class="input-group hidden">
                  <label class="block text-sm font-medium text-gray-700 mb-2">Background Color</label>
                  <input type="text" id="teamBackgroundColor"
                    class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"
                    placeholder="black" />
                </div>
                <div class="input-group hidden">
                  <label class="block text-sm font-medium text-gray-700 mb-2">Title Gradient</label>
                  <input type="text" id="teamTitleGradient"
                    class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"
                    placeholder="from-[#6210FF] to-[#BE2FF4]" />
                </div>
              </div>
              <div id="teamMembers">
                <!-- Team members will be populated by JavaScript -->
              </div>
              <button type="button" onclick="addTeamMember()"
                class="bg-green-600 text-white px-4 py-2 rounded-md hover:bg-green-700 transition-colors mt-4">
                <i class="fas fa-plus mr-2"></i>Add Team Member
              </button>
            </div>
          </form>
        </main>
      </div>
    </div>
  </div>

  <script>
    let currentContent = null;

    // Load current content on page load
    document.addEventListener("DOMContentLoaded", async function () {
      try {
        // First verify session
        const sessionResponse = await fetch("/api/auth/verify", {
          credentials: "include",
        });

        if (sessionResponse.status === 401) {
          window.location.href = "/login.html";
          return;
        }

        await setupMobileMenu();
        await setupLogout();
        await loadCurrentContent();
      } catch (error) {
        console.error("Initialization error:", error);
        window.location.href = "/login.html";
      }
    });

    function setupMobileMenu() {
      const mobileMenuButton = document.getElementById("mobileMenuButton");
      const sidebar = document.getElementById("sidebar");

      mobileMenuButton.addEventListener("click", function () {
        sidebar.classList.toggle("open");
      });

      // Close sidebar when clicking outside on mobile
      document.addEventListener("click", function (event) {
        const isClickInsideSidebar = sidebar.contains(event.target);
        const isClickOnMenuButton = mobileMenuButton.contains(event.target);

        if (
          !isClickInsideSidebar &&
          !isClickOnMenuButton &&
          sidebar.classList.contains("open")
        ) {
          sidebar.classList.remove("open");
        }
      });
    }

    function setupLogout() {
      document
        .getElementById("logoutBtn")
        .addEventListener("click", async function () {
          try {
            const response = await fetch("/api/auth/logout", {
              method: "POST",
            });
            if (response.ok) {
              window.location.href = "/login.html";
            }
          } catch (error) {
            console.error("Logout error:", error);
          }
        });
    }

    async function loadCurrentContent() {
      showLoading(true);
      try {
        const response = await fetch("/api/about-page-content/active");
        const result = await response.json();

        if (result.success && result.data) {
          currentContent = result.data;
          populateForm(currentContent);
        } else {
          console.log("Using default about content");
        }
      } catch (error) {
        console.error("Error loading content:", error);
        showMessage("Error loading content: " + error.message, "error");
      } finally {
        showLoading(false);
      }
    }

    function populateForm(content) {
      // Header Section
      if (content.headerSection) {
        document.getElementById("headerTitleLine1").value =
          content.headerSection.titleLine1 || "";
        document.getElementById("headerTitleLine2").value =
          content.headerSection.titleLine2 || "";
        document.getElementById("headerTitleLine3").value =
          content.headerSection.titleLine3 || "";
        document.getElementById("headerBackgroundGradient").value =
          content.headerSection.backgroundGradient || "";
        document.getElementById("headerHeroImage").value =
          content.headerSection.heroImage || "";
        document.getElementById("headerDecorativeImage").value =
          content.headerSection.decorativeImage || "";
      }

      // About Us Section
      if (content.aboutUsSection) {
        document.getElementById("aboutMainTextLine1").value =
          content.aboutUsSection.mainTextLine1 || "";
        document.getElementById("aboutMainTextLine2").value =
          content.aboutUsSection.mainTextLine2 || "";
        document.getElementById("aboutTextColor").value =
          content.aboutUsSection.textColor || "";
        document.getElementById("aboutBackgroundColor").value =
          content.aboutUsSection.backgroundColor || "";
      }

      // Who Are We Section
      if (content.whoAreWeSection) {
        document.getElementById("whoAreWeTitle").value =
          content.whoAreWeSection.title || "";
        document.getElementById("whoAreWeBackgroundImage").value =
          content.whoAreWeSection.backgroundImage || "";
        document.getElementById("whoAreWeDecorativeArc").value =
          content.whoAreWeSection.leftImages?.decorativeArc || "";
        document.getElementById("whoAreWeAstronaut").value =
          content.whoAreWeSection.leftImages?.astronaut || "";
        document.getElementById("whoAreWeParagraph1").value =
          content.whoAreWeSection.content?.paragraph1 || "";
        document.getElementById("whoAreWeHighlightText").value =
          content.whoAreWeSection.content?.highlightText || "";
        document.getElementById("whoAreWeParagraph1Continuation").value =
          content.whoAreWeSection.content?.paragraph1Continuation || "";
        document.getElementById("whoAreWeParagraph2").value =
          content.whoAreWeSection.content?.paragraph2 || "";
      }

      // Foundation Section
      if (content.foundationSection) {
        document.getElementById("foundationTitle").value =
          content.foundationSection.title || "";
        document.getElementById("foundationBackgroundColor").value =
          content.foundationSection.backgroundColor || "";
        populateFoundationItems(content.foundationSection.foundations || []);
      }

      // Director Section
      if (content.directorSection) {
        document.getElementById("directorSectionTitle").value =
          content.directorSection.sectionTitle || "";
        document.getElementById("directorBackgroundColor").value =
          content.directorSection.backgroundColor || "";
        populateDirectorItems(content.directorSection.directors || []);
      }

      // Team Section
      if (content.teamSection) {
        document.getElementById("teamSectionTitle").value =
          content.teamSection.sectionTitle || "";
        document.getElementById("teamBackgroundColor").value =
          content.teamSection.backgroundColor || "";
        document.getElementById("teamTitleGradient").value =
          content.teamSection.titleGradient || "";
        populateTeamMembers(content.teamSection.teamMembers || []);
      }
    }

    function populateFoundationItems(foundations) {
      const container = document.getElementById("foundationItems");
      container.innerHTML = "";

      // Ensure exactly 4 foundation items
      const items =
        foundations.length >= 4
          ? foundations.slice(0, 4)
          : [
            ...foundations,
            ...Array(4 - foundations.length).fill({
              title: "",
              description: "",
              order: 0,
            }),
          ];

      items.forEach((foundation, index) => {
        const foundationDiv = document.createElement("div");
        foundationDiv.className = "foundation-item";
        foundationDiv.innerHTML = `
                    <h4 class="font-semibold mb-2 text-gray-700">Foundation Item ${index + 1
          }</h4>
                    <div class="grid md:grid-cols-2 gap-4">
                        <div class="input-group">
                            <label class="block text-sm font-medium text-gray-700 mb-2">Title</label>
                            <input type="text" class="foundation-title w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500" value="${foundation.title || ""
          }" placeholder="Foundation title">
                        </div>
                        <div class="input-group">
                            <label class="block text-sm font-medium text-gray-700 mb-2">Description</label>
                            <input type="text" class="foundation-description w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500" value="${foundation.description || ""
          }" placeholder="Foundation description">
                        </div>
                    </div>
                `;
        container.appendChild(foundationDiv);
      });
    }

    function populateDirectorItems(directors) {
      const container = document.getElementById("directorItems");
      container.innerHTML = "";

      directors.forEach((director, index) => {
        const directorDiv = document.createElement("div");
        directorDiv.className = "director-card";
        directorDiv.innerHTML = `
                    <div class="flex justify-between items-center mb-2">
                        <h4 class="font-semibold text-gray-700">Director ${index + 1
          }</h4>
                        <button type="button" onclick="removeDirector(this)" class="bg-red-600 text-white px-3 py-1 rounded-md hover:bg-red-700 transition-colors">
                            <i class="fas fa-trash mr-1"></i>Remove
                        </button>
                    </div>
                    <div class="grid md:grid-cols-2 gap-4">
                        <div class="input-group">
                            <label class="block text-sm font-medium text-gray-700 mb-2">Name</label>
                            <input type="text" class="director-name w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500" value="${director.name || ""
          }" placeholder="Director name">
                        </div>
                        <div class="input-group">
                            <label class="block text-sm font-medium text-gray-700 mb-2">Role</label>
                            <input type="text" class="director-role w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500" value="${director.role || ""
          }" placeholder="Director role">
                        </div>
                        <div class="input-group">
                            <label class="block text-sm font-medium text-gray-700 mb-2">Image Path</label>
                            <div class="flex gap-2 mb-2">
                                <input type="text" class="director-image flex-1 px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500" value="${director.image || ""
          }" placeholder="/director-image.png">
                                <button type="button" onclick="openDirectorImageSelector(this)" class="bg-blue-500 text-white px-3 py-1 rounded-md hover:bg-blue-600 text-sm">
                                    <i class="fas fa-images mr-1"></i>Select
                                </button>
                            </div>
                            <div class="director-image-preview ${director.image ? "" : "hidden"
          }">
                                <img src="${director.image
            ? director.image.startsWith("http")
              ? director.image
              : director.image.startsWith("/uploads/")
                ? "http://15.206.84.81:8000" +
                director.image
                : director.image
            : ""
          }" alt="Preview" class="w-24 h-24 object-cover rounded border">
                            </div>
                        </div>
                    </div>
                    <div class="input-group mt-4">
                        <label class="block text-sm font-medium text-gray-700 mb-2">Description</label>
                        <textarea class="director-description w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500" rows="4" placeholder="Director description and experience">${director.description || ""
          }</textarea>
                    </div>
                    <div class="grid md:grid-cols-2 gap-4 mt-2">
                        <div class="input-group">
                            <label class="block text-sm font-medium text-gray-700 mb-2">Order</label>
                            <input type="number" class="director-order w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500" value="${director.order || index + 1
          }" min="1">
                        </div>
                        <div class="input-group">
                            <label class="block text-sm font-medium text-gray-700 mb-2">Active</label>
                            <select class="director-active w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
                                <option value="true" ${director.isActive !== false ? "selected" : ""
          }>Active</option>
                                <option value="false" ${director.isActive === false ? "selected" : ""
          }>Inactive</option>
                            </select>
                        </div>
                    </div>
                `;
        container.appendChild(directorDiv);
      });
    }

    function populateTeamMembers(teamMembers) {
      const container = document.getElementById("teamMembers");
      container.innerHTML = "";

      teamMembers.forEach((member, index) => {
        const memberDiv = document.createElement("div");
        memberDiv.className = "team-member-card";
        memberDiv.innerHTML = `
                    <div class="flex justify-between items-center mb-2">
                        <h4 class="font-semibold text-gray-700">Team Member ${index + 1
          }</h4>
                        <button type="button" onclick="removeTeamMember(this)" class="bg-red-600 text-white px-3 py-1 rounded-md hover:bg-red-700 transition-colors">
                            <i class="fas fa-trash mr-1"></i>Remove
                        </button>
                    </div>
                    <div class="grid md:grid-cols-3 gap-4">
                        <div class="input-group">
                            <label class="block text-sm font-medium text-gray-700 mb-2">Name</label>
                            <input type="text" class="team-name w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500" value="${member.name || ""
          }" placeholder="Team member name">
                        </div>
                        <div class="input-group">
                            <label class="block text-sm font-medium text-gray-700 mb-2">Role</label>
                            <input type="text" class="team-role w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500" value="${member.role || ""
          }" placeholder="Team member role">
                        </div>
                        <div class="input-group">
                            <label class="block text-sm font-medium text-gray-700 mb-2">Image Path</label>
                            <div class="flex gap-2 mb-2">
                                <input type="text" class="team-image flex-1 px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500" value="${member.image || ""
          }" placeholder="/team-member.png">
                                <button type="button" onclick="openTeamImageSelector(this)" class="bg-blue-500 text-white px-3 py-1 rounded-md hover:bg-blue-600 text-sm">
                                    <i class="fas fa-images mr-1"></i>Select
                                </button>
                            </div>
                            <div class="team-image-preview ${member.image ? "" : "hidden"
          }">
                                <img src="${member.image
            ? member.image.startsWith("http")
              ? member.image
              : member.image.startsWith("/uploads/")
                ? "http://15.206.84.81:8000" +
                member.image
                : member.image
            : ""
          }" alt="Preview" class="w-24 h-24 object-cover rounded border">
                            </div>
                        </div>
                    </div>
                    <div class="grid md:grid-cols-2 gap-4 mt-2">
                        <div class="input-group">
                            <label class="block text-sm font-medium text-gray-700 mb-2">Order</label>
                            <input type="number" class="team-order w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500" value="${member.order || index + 1
          }" min="1">
                        </div>
                        <div class="input-group">
                            <label class="block text-sm font-medium text-gray-700 mb-2">Active</label>
                            <select class="team-active w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
                                <option value="true" ${member.isActive ? "selected" : ""
          }>Active</option>
                                <option value="false" ${!member.isActive ? "selected" : ""
          }>Inactive</option>
                            </select>
                        </div>
                    </div>
                `;
        container.appendChild(memberDiv);
      });
    }

    function addTeamMember() {
      const container = document.getElementById("teamMembers");
      const memberCount = container.children.length;

      const memberDiv = document.createElement("div");
      memberDiv.className = "team-member-card";
      memberDiv.innerHTML = `
                <div class="flex justify-between items-center mb-2">
                    <h4 class="font-semibold text-gray-700">Team Member ${memberCount + 1
        }</h4>
                    <button type="button" onclick="removeTeamMember(this)" class="bg-red-600 text-white px-3 py-1 rounded-md hover:bg-red-700 transition-colors">
                        <i class="fas fa-trash mr-1"></i>Remove
                    </button>
                </div>
                <div class="grid md:grid-cols-3 gap-4">
                    <div class="input-group">
                        <label class="block text-sm font-medium text-gray-700 mb-2">Name</label>
                        <input type="text" class="team-name w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500" placeholder="Team member name">
                    </div>
                    <div class="input-group">
                        <label class="block text-sm font-medium text-gray-700 mb-2">Role</label>
                        <input type="text" class="team-role w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500" placeholder="Team member role">
                    </div>
                    <div class="input-group">
                        <label class="block text-sm font-medium text-gray-700 mb-2">Image Path</label>
                        <div class="flex gap-2 mb-2">
                            <input type="text" class="team-image flex-1 px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500" placeholder="/team-member.png">
                            <button type="button" onclick="openTeamImageSelector(this)" class="bg-blue-500 text-white px-3 py-1 rounded-md hover:bg-blue-600 text-sm">
                                <i class="fas fa-images mr-1"></i>Select
                            </button>
                        </div>
                        <div class="team-image-preview hidden">
                            <img src="" alt="Preview" class="w-24 h-24 object-cover rounded border">
                        </div>
                    </div>
                </div>
                <div class="grid md:grid-cols-2 gap-4 mt-2">
                    <div class="input-group">
                        <label class="block text-sm font-medium text-gray-700 mb-2">Order</label>
                        <input type="number" class="team-order w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500" value="${memberCount + 1
        }" min="1">
                    </div>
                    <div class="input-group">
                        <label class="block text-sm font-medium text-gray-700 mb-2">Active</label>
                        <select class="team-active w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
                            <option value="true" selected>Active</option>
                            <option value="false">Inactive</option>
                        </select>
                    </div>
                </div>
            `;
      container.appendChild(memberDiv);
    }

    function removeTeamMember(button) {
      button.closest(".team-member-card").remove();
      updateTeamMemberNumbers();
    }

    function updateTeamMemberNumbers() {
      const teamMembers = document.querySelectorAll(".team-member-card");
      teamMembers.forEach((member, index) => {
        const header = member.querySelector("h4");
        header.textContent = `Team Member ${index + 1}`;

        const orderInput = member.querySelector(".team-order");
        if (!orderInput.value) {
          orderInput.value = index + 1;
        }
      });
    }

    function addDirector() {
      const container = document.getElementById("directorItems");
      const directorCount = container.children.length;

      const directorDiv = document.createElement("div");
      directorDiv.className = "director-card";
      directorDiv.innerHTML = `
                <div class="flex justify-between items-center mb-2">
                    <h4 class="font-semibold text-gray-700">Director ${directorCount + 1
        }</h4>
                    <button type="button" onclick="removeDirector(this)" class="bg-red-600 text-white px-3 py-1 rounded-md hover:bg-red-700 transition-colors">
                        <i class="fas fa-trash mr-1"></i>Remove
                    </button>
                </div>
                <div class="grid md:grid-cols-2 gap-4">
                    <div class="input-group">
                        <label class="block text-sm font-medium text-gray-700 mb-2">Name</label>
                        <input type="text" class="director-name w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500" placeholder="Director name">
                    </div>
                    <div class="input-group">
                        <label class="block text-sm font-medium text-gray-700 mb-2">Role</label>
                        <input type="text" class="director-role w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500" placeholder="Director role">
                    </div>
                    <div class="input-group">
                        <label class="block text-sm font-medium text-gray-700 mb-2">Image Path</label>
                        <div class="flex gap-2 mb-2">
                            <input type="text" class="director-image flex-1 px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500" placeholder="/director-image.png">
                            <button type="button" onclick="openDirectorImageSelector(this)" class="bg-blue-500 text-white px-3 py-1 rounded-md hover:bg-blue-600 text-sm">
                                <i class="fas fa-images mr-1"></i>Select
                            </button>
                        </div>
                        <div class="director-image-preview hidden">
                            <img src="" alt="Preview" class="w-24 h-24 object-cover rounded border">
                        </div>
                    </div>
                </div>
                <div class="input-group mt-4">
                    <label class="block text-sm font-medium text-gray-700 mb-2">Description</label>
                    <textarea class="director-description w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500" rows="4" placeholder="Director description and experience"></textarea>
                </div>
                <div class="grid md:grid-cols-2 gap-4 mt-2">
                    <div class="input-group">
                        <label class="block text-sm font-medium text-gray-700 mb-2">Order</label>
                        <input type="number" class="director-order w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500" value="${directorCount + 1
        }" min="1">
                    </div>
                    <div class="input-group">
                        <label class="block text-sm font-medium text-gray-700 mb-2">Active</label>
                        <select class="director-active w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
                            <option value="true" selected>Active</option>
                            <option value="false">Inactive</option>
                        </select>
                    </div>
                </div>
            `;
      container.appendChild(directorDiv);
    }

    function removeDirector(button) {
      button.closest(".director-card").remove();
      updateDirectorNumbers();
    }

    function updateDirectorNumbers() {
      const directors = document.querySelectorAll(".director-card");
      directors.forEach((director, index) => {
        const header = director.querySelector("h4");
        header.textContent = `Director ${index + 1}`;

        const orderInput = director.querySelector(".director-order");
        if (!orderInput.value) {
          orderInput.value = index + 1;
        }
      });
    }

    function getFoundationItems() {
      const foundationItems = [];
      const foundationElements =
        document.querySelectorAll(".foundation-item");

      foundationElements.forEach((element, index) => {
        const title = element.querySelector(".foundation-title").value;
        const description = element.querySelector(
          ".foundation-description"
        ).value;

        if (title && description) {
          foundationItems.push({
            title: title,
            description: description,
            order: index + 1,
          });
        }
      });

      return foundationItems;
    }

    function getDirectorItems() {
      const directorItems = [];
      const directorElements = document.querySelectorAll(".director-card");

      directorElements.forEach((element, index) => {
        const name = element.querySelector(".director-name").value;
        const role = element.querySelector(".director-role").value;
        const image = element.querySelector(".director-image").value;
        const description = element.querySelector(
          ".director-description"
        ).value;
        const order =
          parseInt(element.querySelector(".director-order").value) ||
          index + 1;
        const isActive =
          element.querySelector(".director-active").value === "true";

        if (name && image && description) {
          directorItems.push({
            name: name,
            role: role,
            image: image,
            description: description,
            order: order,
            isActive: isActive,
          });
        }
      });

      return directorItems;
    }

    function getTeamMembers() {
      const teamMembers = [];
      const teamElements = document.querySelectorAll(".team-member-card");

      teamElements.forEach((element, index) => {
        const name = element.querySelector(".team-name").value;
        const role = element.querySelector(".team-role").value;
        const image = element.querySelector(".team-image").value;
        const order =
          parseInt(element.querySelector(".team-order").value) || index + 1;
        const isActive =
          element.querySelector(".team-active").value === "true";

        if (name && role && image) {
          teamMembers.push({
            name: name,
            role: role,
            image: image,
            order: order,
            isActive: isActive,
          });
        }
      });

      return teamMembers;
    }

    // Save button event listener
    document.getElementById("saveBtn").addEventListener("click", saveContent);

    async function saveContent() {
      const saveBtn = document.getElementById("saveBtn");
      const originalText = saveBtn.innerHTML;
      saveBtn.innerHTML =
        '<i class="fas fa-spinner fa-spin mr-2"></i>Saving...';
      saveBtn.disabled = true;

      showLoading(true);
      try {
        const contentData = {
          headerSection: {
            titleLine1: document.getElementById("headerTitleLine1").value,
            titleLine2: document.getElementById("headerTitleLine2").value,
            titleLine3: document.getElementById("headerTitleLine3").value,
            backgroundGradient: document.getElementById(
              "headerBackgroundGradient"
            ).value,
            heroImage: document.getElementById("headerHeroImage").value,
            decorativeImage: document.getElementById("headerDecorativeImage")
              .value,
          },
          aboutUsSection: {
            mainTextLine1:
              document.getElementById("aboutMainTextLine1").value,
            mainTextLine2:
              document.getElementById("aboutMainTextLine2").value,
            textColor: document.getElementById("aboutTextColor").value,
            backgroundColor: document.getElementById("aboutBackgroundColor")
              .value,
          },
          whoAreWeSection: {
            title: document.getElementById("whoAreWeTitle").value,
            backgroundImage: document.getElementById(
              "whoAreWeBackgroundImage"
            ).value,
            leftImages: {
              decorativeArc: document.getElementById("whoAreWeDecorativeArc")
                .value,
              astronaut: document.getElementById("whoAreWeAstronaut").value,
            },
            content: {
              paragraph1: document.getElementById("whoAreWeParagraph1").value,
              highlightText: document.getElementById("whoAreWeHighlightText")
                .value,
              paragraph1Continuation: document.getElementById(
                "whoAreWeParagraph1Continuation"
              ).value,
              paragraph2: document.getElementById("whoAreWeParagraph2").value,
            },
          },
          foundationSection: {
            title: document.getElementById("foundationTitle").value,
            backgroundColor: document.getElementById(
              "foundationBackgroundColor"
            ).value,
            foundations: getFoundationItems(),
          },
          directorSection: {
            sectionTitle: document.getElementById("directorSectionTitle")
              .value,
            backgroundColor: document.getElementById(
              "directorBackgroundColor"
            ).value,
            directors: getDirectorItems(),
          },
          teamSection: {
            sectionTitle: document.getElementById("teamSectionTitle").value,
            backgroundColor: document.getElementById("teamBackgroundColor")
              .value,
            titleGradient: document.getElementById("teamTitleGradient").value,
            teamMembers: getTeamMembers(),
          },
          isActive: true,
          version: "1.0",
          lastUpdatedBy: "Admin",
        };

        const response = await fetch("/api/about-page-content", {
          method: "POST",
          headers: {
            "Content-Type": "application/json",
          },
          body: JSON.stringify(contentData),
        });

        const result = await response.json();

        if (result.success) {
          showMessage("About page content saved successfully!", "success");
          currentContent = result.data;
        } else {
          showMessage("Error saving content: " + result.message, "error");
        }
      } catch (error) {
        console.error("Error saving content:", error);
        showMessage("Error saving content: " + error.message, "error");
      } finally {
        saveBtn.innerHTML = originalText;
        saveBtn.disabled = false;
        showLoading(false);
      }
    }

    function showLoading(show) {
      const overlay = document.getElementById("loadingOverlay");
      const mainContent = document.getElementById("mainContent");

      if (show) {
        overlay.classList.remove("hidden");
        mainContent.classList.add("hidden");
      } else {
        overlay.classList.add("hidden");
        mainContent.classList.remove("hidden");
      }
    }

    function showMessage(message, type) {
      const messageContainer = document.getElementById("messageContainer");
      messageContainer.className = `mx-4 mt-4 p-4 rounded-lg ${type === "success"
          ? "bg-green-100 border border-green-400 text-green-700"
          : "bg-red-100 border border-red-400 text-red-700"
        }`;
      messageContainer.textContent = message;
      messageContainer.classList.remove("hidden");

      setTimeout(() => {
        messageContainer.classList.add("hidden");
      }, 5000);
    }

    // Image Upload and Management Functions
    let currentImageInputId = null;
    let currentDirectorImageInput = null;
    let currentTeamImageInput = null;

    function getImageUrl(imagePath) {
      if (!imagePath) return "";
      if (imagePath.startsWith("http")) return imagePath;
      if (imagePath.startsWith("/uploads/"))
        return `http://15.206.84.81:8000${imagePath}`;
      return imagePath;
    }

    function openImageSelector(inputId) {
      currentImageInputId = inputId;
      loadImages();
      document.getElementById("imageModal").classList.remove("hidden");
    }

    function openDirectorImageSelector(button) {
      const directorInput =
        button.parentElement.querySelector(".director-image");
      currentImageInputId = "director-image-temp";
      currentDirectorImageInput = directorInput;
      loadImages();
      document.getElementById("imageModal").classList.remove("hidden");
    }

    function openTeamImageSelector(button) {
      const teamInput = button.parentElement.querySelector(".team-image");
      currentImageInputId = "team-image-temp";
      currentTeamImageInput = teamInput;
      loadImages();
      document.getElementById("imageModal").classList.remove("hidden");
    }

    function closeImageModal() {
      document.getElementById("imageModal").classList.add("hidden");
      currentImageInputId = null;
      currentDirectorImageInput = null;
      currentTeamImageInput = null;
    }

    async function loadImages() {
      try {
        const response = await fetch("/api/images/list");
        const result = await response.json();

        if (result.success) {
          populateImageGrid(result.data);
        } else {
          console.error("Error loading images:", result.message);
        }
      } catch (error) {
        console.error("Error loading images:", error);
      }
    }

    function populateImageGrid(images) {
      const grid = document.getElementById("imageGrid");
      grid.innerHTML = "";

      images.forEach((image) => {
        const imageItem = document.createElement("div");
        imageItem.className =
          "relative group border-2 border-gray-200 hover:border-blue-500 rounded-lg overflow-hidden";

        imageItem.innerHTML = `
                    <div class="cursor-pointer" onclick="selectImage('${image.url}')">
                        <img src="${image.url}" alt="${image.filename}" class="w-full h-24 object-cover">
                        <div class="absolute inset-0 bg-black bg-opacity-0 group-hover:bg-opacity-20 flex items-center justify-center">
                            <i class="fas fa-check text-white opacity-0 group-hover:opacity-100 text-xl"></i>
                        </div>
                    </div>
                    <div class="absolute bottom-0 left-0 right-0 bg-black bg-opacity-50 text-white text-xs p-1 truncate">
                        ${image.filename}
                    </div>
                    <button 
                        onclick="deleteImage('${image.filename}', event)" 
                        class="absolute top-1 right-1 bg-red-500 text-white rounded-full w-6 h-6 flex items-center justify-center opacity-0 group-hover:opacity-100 hover:bg-red-600 transition-opacity duration-200"
                        title="Delete image"
                    >
                        <i class="fas fa-trash text-xs"></i>
                    </button>
                `;

        grid.appendChild(imageItem);
      });
    }

    function selectImage(imageUrl) {
      if (
        currentImageInputId === "director-image-temp" &&
        currentDirectorImageInput
      ) {
        // Handle director image selection
        currentDirectorImageInput.value = imageUrl;
        const previewElement =
          currentDirectorImageInput.parentElement.nextElementSibling;
        if (
          previewElement &&
          previewElement.classList.contains("director-image-preview")
        ) {
          const img = previewElement.querySelector("img");
          if (img) {
            img.src = getImageUrl(imageUrl);
            previewElement.classList.remove("hidden");
          }
        }
        closeImageModal();
      } else if (
        currentImageInputId === "team-image-temp" &&
        currentTeamImageInput
      ) {
        // Handle team image selection
        currentTeamImageInput.value = imageUrl;
        const previewElement =
          currentTeamImageInput.parentElement.nextElementSibling;
        if (
          previewElement &&
          previewElement.classList.contains("team-image-preview")
        ) {
          const img = previewElement.querySelector("img");
          if (img) {
            img.src = getImageUrl(imageUrl);
            previewElement.classList.remove("hidden");
          }
        }
        closeImageModal();
      } else if (currentImageInputId) {
        // Handle regular image selection
        document.getElementById(currentImageInputId).value = imageUrl;
        updateImagePreview(currentImageInputId, imageUrl);
        closeImageModal();
      }
    }

    function updateImagePreview(inputId, imageUrl) {
      const previewElement = document.getElementById(inputId + "Preview13245");
      if (previewElement) {
        const img = previewElement.querySelector("img");
        img.src = getImageUrl(imageUrl);
        previewElement.classList.remove("hidden");
      }
    }

    async function uploadImage() {
      const fileInput = document.getElementById("imageUploadInput");
      const file = fileInput.files[0];

      if (!file) {
        alert("Please select a file to upload");
        return;
      }

      const formData = new FormData();
      formData.append("image", file);

      try {
        document.getElementById("uploadProgress").classList.remove("hidden");

        const response = await fetch("/api/images/upload", {
          method: "POST",
          body: formData,
        });

        const result = await response.json();

        if (result.success) {
          alert("Image uploaded successfully!");
          fileInput.value = "";
          loadImages(); // Refresh the image grid
        } else {
          alert("Error uploading image: " + result.message);
        }
      } catch (error) {
        console.error("Upload error:", error);
        alert("Error uploading image");
      } finally {
        document.getElementById("uploadProgress").classList.add("hidden");
      }
    }

    async function deleteImage(filename, event) {
      event.stopPropagation();

      if (
        !confirm(
          `Are you sure you want to delete "${filename}"? This action cannot be undone.`
        )
      ) {
        return;
      }

      try {
        const response = await fetch(`/api/images/delete/${filename}`, {
          method: "DELETE",
        });

        const result = await response.json();

        if (result.success) {
          alert("Image deleted successfully!");
          loadImages(); // Refresh the image grid
        } else {
          alert("Error deleting image: " + result.message);
        }
      } catch (error) {
        console.error("Delete error:", error);
        alert("Error deleting image");
      }
    }

    // Update image previews on page load
    function updateAllImagePreviews() {
      const imageInputs = [
        "headerHeroImage",
        "headerDecorativeImage",
        "whoAreWeBackgroundImage",
        "whoAreWeDecorativeArc",
        "whoAreWeAstronaut",
      ];

      imageInputs.forEach((inputId) => {
        const input = document.getElementById(inputId);
        if (input && input.value) {
          updateImagePreview(inputId, input.value);
        }
      });
    }

    // Call this function when the page loads
    document.addEventListener("DOMContentLoaded", function () {
      setTimeout(updateAllImagePreviews, 1000); // Allow time for content to load
    });
  </script>

  <!-- Image Upload Modal -->
  <div id="imageModal" class="hidden fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center">
    <div class="bg-white rounded-lg shadow-xl max-w-4xl w-full mx-4 max-h-[90vh] overflow-hidden">
      <div class="flex justify-between items-center p-4 border-b">
        <h3 class="text-lg font-semibold">Select Image</h3>
        <button onclick="closeImageModal()" class="text-gray-500 hover:text-gray-700">
          <i class="fas fa-times text-xl"></i>
        </button>
      </div>

      <div class="p-4">
        <!-- Upload Section -->
        <div class="mb-6 p-4 border-2 border-dashed border-gray-300 rounded-lg">
          <div class="text-center">
            <i class="fas fa-cloud-upload-alt text-3xl text-gray-400 mb-2"></i>
            <p class="text-gray-600 mb-2">Upload a new image</p>
            <input type="file" id="imageUploadInput" accept="image/*" class="mb-2" />
            <button onclick="uploadImage()" class="bg-green-500 text-white px-4 py-2 rounded-md hover:bg-green-600">
              <i class="fas fa-upload mr-1"></i>Upload
            </button>
            <div id="uploadProgress" class="hidden mt-2">
              <div class="text-blue-600">Uploading...</div>
            </div>
          </div>
        </div>

        <!-- Image Grid -->
        <div class="mb-4">
          <h4 class="text-md font-semibold mb-2">
            Select from uploaded images:
          </h4>
          <div id="imageGrid" class="grid grid-cols-6 gap-2 max-h-64 overflow-y-auto">
            <!-- Images will be loaded here -->
          </div>
        </div>
      </div>
    </div>
  </div>
</body>

</html>